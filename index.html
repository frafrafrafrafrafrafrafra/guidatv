<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guida TV</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
      transition: background-color 0.3s, color 0.3s;
    }
    h1 {
      text-align: center;
      margin-bottom: 5px;
    }
    h2 {
      text-align: center;
      font-weight: normal;
      color: #555;
      margin-top: 0;
      margin-bottom: 20px;
    }
    .search-container {
      max-width: 90vw;
      margin: 0 auto 20px auto;
      display: flex;
      justify-content: center;
      padding: 0 10px;
      box-sizing: border-box;
    }
    #search-input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      max-width: none;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    /* Lista principale */
    ul {
      list-style: none;
      padding: 0;
      max-width: 90vw;
      margin: 0 auto 30px auto;
      flex-grow: 1;
      box-sizing: border-box;
      padding: 0 10px;
    }
    li {
      background: white;
      margin: 8px 0;
      padding: 12px;
      border-radius: 5px;
      transition: background-color 0.3s, color 0.3s;
      user-select: none;
      cursor: default;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    li.favorite {
      border: 2px solid #f9a825; /* giallo oro per preferiti */
      box-shadow: 0 0 8px rgba(249,168,37,0.4);
    }
    a {
      text-decoration: none;
      color: #333;
      font-weight: bold;
      flex-grow: 1;
      transition: color 0.3s;
    }
    a:hover {
      color: #0077cc;
    }
    /* Titolo sezione preferiti */
    #favorites-title {
      max-width: 90vw;
      margin: 0 auto 10px auto;
      font-weight: bold;
      font-size: 18px;
      color: #f9a825;
      user-select: none;
      padding-left: 15px;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      color: #777;
      font-size: 14px;
      user-select: none;
      cursor: pointer;
      transition: color 0.3s, background-color 0.3s;
      padding: 8px 0;
      background: transparent;
      border-radius: 4px;
    }
    footer:hover {
      color: #0077cc;
      background: rgba(0, 119, 204, 0.1);
    }

    /* --- Modalit√† scura --- */
    body.dark-mode {
      background: #121212;
      color: #ddd;
    }
    body.dark-mode h2 {
      color: #aaa;
    }
    body.dark-mode #search-input {
      background: #222;
      color: #eee;
      border-color: #555;
    }
    body.dark-mode li {
      background: #1e1e1e;
      color: #ccc;
    }
    body.dark-mode li.favorite {
      border-color: #f9a825;
      box-shadow: 0 0 8px rgba(249,168,37,0.8);
      background: #292921;
    }
    body.dark-mode a {
      color: #ccc;
    }
    body.dark-mode a:hover {
      color: #66aaff;
    }
    body.dark-mode #favorites-title {
      color: #f9a825;
    }
    body.dark-mode footer {
      background: transparent !important;
      color: #bbb;
    }
    body.dark-mode footer:hover {
      background: rgba(102, 170, 255, 0.15);
      color: #aaddff;
    }

    /* Stile bottone stella */
    button.favorite-btn {
      margin-left: 10px;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 18px;
      user-select: none;
      color: #999;
      transition: color 0.3s;
      flex-shrink: 0;
    }
    button.favorite-btn:hover {
      color: #f9a825;
    }
    button.favorite-btn.active {
      color: #f9a825;
    }
  </style>
</head>
<body>
  <h1>Guida TV</h1>
  <h2>Seleziona un canale</h2>

  <div class="search-container">
    <input type="text" id="search-input" placeholder="Cerca un canale..." />
  </div>

  <!-- Titolo e lista preferiti, nascosti se nessun preferito -->
  <div id="favorites-section" style="display:none;">
    <div id="favorites-title">‚≠ê Preferiti</div>
    <ul id="favorites-list"></ul>
  </div>

  <ul id="channel-list"></ul>

  <footer id="toggle-dark-mode" title="Clicca per attivare/disattivare la modalit√† scura">
    Powered by üêØ - Modalit√† Scura OFF
  </footer>

  <script>
    const CHANNELS = [
      {"name":"CNBC HD","site_id":"DTH_10713"},
      {"name":"Sky Crime","site_id":"DTH_11216"},
      {"name":"Sky Serie +1","site_id":"DTH_11247"},
      {"name":"Sky Sport","site_id":"DTH_11490"},
      {"name":"Sky Sport","site_id":"DTH_11491"},
      {"name":"Sky Sport","site_id":"DTH_11492"},
      {"name":"Sky Sport","site_id":"DTH_11494"},
      {"name":"Sky Sport","site_id":"DTH_11496"},
      {"name":"Sky Sport","site_id":"DTH_11497"},
      {"name":"Sky News","site_id":"DTH_445"},
      {"name":"Sky Sport","site_id":"DTH_617"},
      {"name":"NHK World TV HD","site_id":"DTH_6862"},
      {"name":"Sky Crime","site_id":"DTH_8336"},
      {"name":"Sky Atlantic +1","site_id":"DTH_8453"},
      {"name":"Heroes Collection","site_id":"DTH_9047"},
      {"name":"20Mediaset HD","site_id":"DTH_10458"},
      {"name":"ACI Sport Tv","site_id":"DTH_7587"},
      {"name":"Al Jazeera Intl. HD","site_id":"DTH_5113"},
      {"name":"BBC World News","site_id":"DTH_891"},
      {"name":"BIKE","site_id":"DTH_11278"},
      {"name":"Bloomberg","site_id":"DTH_349"},
      {"name":"Boing","site_id":"DTH_6628"},
      {"name":"Boomerang","site_id":"DTH_472"},
      {"name":"Boomerang +1","site_id":"DTH_479"},
      {"name":"CNN Intl.","site_id":"DTH_312"},
      {"name":"CACCIA e Pesca","site_id":"DTH_520"},
      {"name":"Canale 5 HD","site_id":"DTH_10354"},
      {"name":"Cartoon Network HD","site_id":"DTH_9693"},
      {"name":"Cartoon +1","site_id":"DTH_476"},
      {"name":"CARTOONITO DTT","site_id":"DTH_8132"},
      {"name":"cielo","site_id":"DTH_8133"},
      {"name":"Cine34 HD","site_id":"DTH_10893"},
      {"name":"Class CNBC","site_id":"DTH_308"},
      {"name":"Classica HD","site_id":"DTH_11437"},
      {"name":"Comedy Central","site_id":"DTH_318"},
      {"name":"Comedy +1","site_id":"DTH_8353"},
      {"name":"DMAX HD","site_id":"DTH_8933"},
      {"name":"DeAJunior","site_id":"DTH_7427"},
      {"name":"DeAKids","site_id":"DTH_460"},
      {"name":"DeAKids +1","site_id":"DTH_364"},
      {"name":"Deejay TV","site_id":"DTH_462"},
      {"name":"Discovery HD","site_id":"DTH_9059"},
      {"name":"Discovery +1","site_id":"DTH_331"},
      {"name":"EQUtv","site_id":"DTH_8293"},
      {"name":"Emilia Romagna 24","site_id":"DTH_10615"},
      {"name":"Euronews","site_id":"DTH_801"},
      {"name":"Eurosport HD","site_id":"DTH_9057"},
      {"name":"Eurosport 2 HD","site_id":"DTH_9060"},
      {"name":"Explorer HD Channel","site_id":"DTH_11262"},
      {"name":"Fashion TV","site_id":"DTH_810"},
      {"name":"Focus HD","site_id":"DTH_10470"},
      {"name":"Food Network HD","site_id":"DTH_10534"},
      {"name":"Fox Business","site_id":"DTH_6741"},
      {"name":"Fox News","site_id":"DTH_446"},
      {"name":"France 24 English HD","site_id":"DTH_7968"},
      {"name":"France 24 Francais HD","site_id":"DTH_5119"},
      {"name":"-frisbee-","site_id":"DTH_6610"},
      {"name":"Gambero Rosso HD","site_id":"DTH_9099"},
      {"name":"Gambero Rosso HD","site_id":"DTH_11055"},
      {"name":"GIALLO HD","site_id":"DTH_8131"},
      {"name":"HGTV HD","site_id":"DTH_11154"},
      {"name":"History HD","site_id":"DTH_9101"},
      {"name":"History +1","site_id":"DTH_123"},
      {"name":"Horse TV HD","site_id":"DTH_6611"},
      {"name":"i24news","site_id":"DTH_8273"},
      {"name":"Inter TV","site_id":"DTH_9893"},
      {"name":"Iris HD","site_id":"DTH_10467"},
      {"name":"Italia 1 HD","site_id":"DTH_10454"},
      {"name":"Mediaset Italia2 HD","site_id":"DTH_10469"},
      {"name":"K2","site_id":"DTH_6240"},
      {"name":"LA7D","site_id":"DTH_6624"},
      {"name":"LA7 HD","site_id":"DTH_319"},
      {"name":"La 5 HD","site_id":"DTH_10466"},
      {"name":"Lazio Style HD","site_id":"DTH_7527"},
      {"name":"MTV HD","site_id":"DTH_9195"},
      {"name":"MTV Music","site_id":"DTH_528"},
      {"name":"MTV Music","site_id":"DTH_11054"},
      {"name":"Mediaset Extra HD","site_id":"DTH_10465"},
      {"name":"Milan TV","site_id":"DTH_9513"},
      {"name":"Motor Trend HD","site_id":"DTH_8130"},
      {"name":"Nick Jr","site_id":"DTH_461"},
      {"name":"Nick Jr +1","site_id":"DTH_6701"},
      {"name":"Nickelodeon","site_id":"DTH_320"},
      {"name":"Nickelodeon +1","site_id":"DTH_6140"},
      {"name":"NOVE HD","site_id":"DTH_9753"},
      {"name":"Caccia e PESCA","site_id":"DTH_6220"},
      {"name":"QVC","site_id":"DTH_6626"},
      {"name":"RTL 102.5 HD","site_id":"DTH_6885"},
      {"name":"Radio Italia TV HD","site_id":"DTH_9833"},
      {"name":"Radio Italia Trend Tv HD","site_id":"DTH_10033"},
      {"name":"Radio Monte Carlo","site_id":"DTH_10993"},
      {"name":"RADIONORBA TV","site_id":"DTH_8213"},
      {"name":"RADIOFRECCIA HD","site_id":"DTH_10616"},
      {"name":"Rai 1 HD","site_id":"DTH_899"},
      {"name":"Rai 2 HD","site_id":"DTH_898"},
      {"name":"Rai 3 HD","site_id":"DTH_897"},
      {"name":"Rai 4","site_id":"DTH_6622"},
      {"name":"Rai 5","site_id":"DTH_6607"},
      {"name":"Rai Gulp","site_id":"DTH_6629"},
      {"name":"Rai Movie","site_id":"DTH_6608"},
      {"name":"Rai News 24","site_id":"DTH_895"},
      {"name":"Rai Premium","site_id":"DTH_6623"},
      {"name":"RAI Sport","site_id":"DTH_807"},
      {"name":"Rai Storia","site_id":"DTH_6630"},
      {"name":"Rai Yoyo","site_id":"DTH_6609"},
      {"name":"Real Time HD","site_id":"DTH_8173"},
      {"name":"Rete 4 HD","site_id":"DTH_10464"},
      {"name":"San Marino RTV","site_id":"DTH_6861"},
      {"name":"Sky Arte","site_id":"DTH_7767"},
      {"name":"Sky Arte","site_id":"DTH_8473"},
      {"name":"Sky Arte +1","site_id":"DTH_11276"},
      {"name":"Sky Arte +1","site_id":"DTH_11277"},
      {"name":"Sky Atlantic","site_id":"DTH_9095"},
      {"name":"Sky Cinema Action","site_id":"DTH_9050"},
      {"name":"Sky Cinema Comedy","site_id":"DTH_9039"},
      {"name":"Sky Cinema Drama","site_id":"DTH_10518"},
      {"name":"Sky Cinema Due","site_id":"DTH_9034"},
      {"name":"Sky Cinema Due +24","site_id":"DTH_10517"},
      {"name":"Sky Cinema Family","site_id":"DTH_9042"},
      {"name":"Sky Cinema Romance","site_id":"DTH_9055"},
      {"name":"Sky Cinema Suspense","site_id":"DTH_10515"},
      {"name":"Sky Cinema Uno","site_id":"DTH_9044"},
      {"name":"Sky Cinema Uno +24","site_id":"DTH_9037"},
      {"name":"Sky Documentaries","site_id":"DTH_11239"},
      {"name":"Sky Documentaries","site_id":"DTH_11241"},
      {"name":"Sky Documentaries +1","site_id":"DTH_11240"},
      {"name":"Sky Documentaries +1","site_id":"DTH_11243"},
      {"name":"Sky Investigation","site_id":"DTH_11246"},
      {"name":"Sky Investigation +1 HD","site_id":"DTH_11238"},
      {"name":"Sky Meteo24","site_id":"DTH_321"},
      {"name":"Sky Nature","site_id":"DTH_11242"},
      {"name":"Sky Nature","site_id":"DTH_11245"},
      {"name":"Sky Serie","site_id":"DTH_11244"},
      {"name":"Sky Sport 4K","site_id":"DTH_10013"},
      {"name":"Sky Sport","site_id":"DTH_9046"},
      {"name":"Sky Sport","site_id":"DTH_8613"},
      {"name":"Sky Sport","site_id":"DTH_615"},
      {"name":"Sky Sport24","site_id":"DTH_929"},
      {"name":"Sky Sport Arena","site_id":"DTH_7507"},
      {"name":"Sky Sport Calcio","site_id":"DTH_9113"},
      {"name":"Sky Sport F1","site_id":"DTH_9096"},
      {"name":"Sky Sport Golf","site_id":"DTH_10254"},
      {"name":"Sky Sport Max","site_id":"DTH_9103"},
      {"name":"Sky Sport MotoGP","site_id":"DTH_8434"},
      {"name":"Sky Sport NBA","site_id":"DTH_8753"},
      {"name":"Sky Sport Tennis","site_id":"DTH_11237"},
      {"name":"Sky Sport Uno","site_id":"DTH_8714"},
      {"name":"TG24PrimoPiano","site_id":"DTH_6510"},
      {"name":"Sky TG24","site_id":"DTH_9117"},
      {"name":"Sky Uno","site_id":"DTH_9115"},
      {"name":"Sky Uno +1","site_id":"DTH_9114"},
      {"name":"Super!","site_id":"DTH_6460"},
      {"name":"SuperTennis HD","site_id":"DTH_6000"},
      {"name":"TG NORBA 24","site_id":"DTH_6481"},
      {"name":"TgCom24 HD","site_id":"DTH_10473"},
      {"name":"TRM h24","site_id":"DTH_9013"},
      {"name":"TV8 HD","site_id":"DTH_8195"},
      {"name":"TV2000 HD","site_id":"DTH_7588"},
      {"name":"TOPcrime HD","site_id":"DTH_10468"},
      {"name":"27Twentyseven HD","site_id":"DTH_11342"},
      {"name":"VH1 HD","site_id":"DTH_10918"},
      {"name":"Virgin Radio","site_id":"DTH_11344"},
      {"name":"ZONA DAZN 2","site_id":"DTH_11401"},
      {"name":"ZONA DAZN 3","site_id":"DTH_11403"},
      {"name":"ZONA DAZN 4","site_id":"DTH_11405"},
      {"name":"ZONA DAZN 5","site_id":"DTH_11404"},
      {"name":"ZONA DAZN","site_id":"DTH_11402"}
    ];

    const footer = document.getElementById('toggle-dark-mode');
    const searchInput = document.getElementById('search-input');
    const channelList = document.getElementById('channel-list');
    const favoritesSection = document.getElementById('favorites-section');
    const favoritesList = document.getElementById('favorites-list');

    // Recupera i preferiti dal localStorage, oppure array vuoto
    let favorites = JSON.parse(localStorage.getItem('favoritesChannels') || '[]');

    // Salva preferiti su localStorage
    function saveFavorites() {
      localStorage.setItem('favoritesChannels', JSON.stringify(favorites));
    }

    // Crea elemento <li> canale, con link e bottone stella
    function createChannelLi(channel) {
      const li = document.createElement('li');
      if (favorites.includes(channel.site_id)) {
        li.classList.add('favorite');
      }

      const a = document.createElement('a');
      a.href = `guide.html?site_id=${encodeURIComponent(channel.site_id)}&name=${encodeURIComponent(channel.name)}`;
      a.textContent = channel.name;
      a.title = 'Apri guida TV';

      // Bottone stella per preferiti
      const favBtn = document.createElement('button');
      favBtn.classList.add('favorite-btn');
      favBtn.innerHTML = favorites.includes(channel.site_id) ? '‚≠ê' : '‚òÜ';
      if (favorites.includes(channel.site_id)) {
        favBtn.classList.add('active');
      }
      favBtn.title = favorites.includes(channel.site_id) ? 'Rimuovi dai preferiti' : 'Aggiungi ai preferiti';
      favBtn.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        toggleFavorite(channel.site_id);
      });

      li.appendChild(a);
      li.appendChild(favBtn);

      return li;
    }

    // Toggle preferito
    function toggleFavorite(site_id) {
      const idx = favorites.indexOf(site_id);
      if (idx === -1) {
        favorites.push(site_id);
      } else {
        favorites.splice(idx, 1);
      }
      saveFavorites();
      rebuildLists();
    }

    // Filtra canali per testo (case insensitive)
    function filterChannels(text) {
      const lowerText = text.toLowerCase();
      return CHANNELS.filter(ch => ch.name.toLowerCase().includes(lowerText));
    }

    // Ricostruisce entrambe le liste: preferiti e principali, in base a filtro
    function rebuildLists() {
      const filterText = searchInput.value.trim().toLowerCase();

      // Canali filtrati
      const filteredChannels = filterChannels(filterText);
      filteredChannels.sort((a, b) => a.name.toLowerCase().localeCompare(b.name.toLowerCase()));

      // Preferiti filtrati
      const filteredFavorites = filteredChannels.filter(ch => favorites.includes(ch.site_id));

      // Mostra o nascondi sezione preferiti
      if (filteredFavorites.length > 0) {
        favoritesSection.style.display = 'block';
      } else {
        favoritesSection.style.display = 'none';
      }

      // Pulisci liste
      favoritesList.innerHTML = '';
      channelList.innerHTML = '';

      // Aggiungi preferiti
      filteredFavorites.forEach(ch => {
        const li = createChannelLi(ch);
        favoritesList.appendChild(li);
      });

      // Aggiungi canali (non preferiti)
      filteredChannels.forEach(ch => {
        if (!favorites.includes(ch.site_id)) {
          const li = createChannelLi(ch);
          channelList.appendChild(li);
        }
      });
    }

    // --- Gestione modalit√† scura ---
    function updateDarkModeUI(isDark) {
      if (isDark) {
        document.body.classList.add('dark-mode');
        footer.textContent = 'Powered by üêØ - Modalit√† Scura ON';
      } else {
        document.body.classList.remove('dark-mode');
        footer.textContent = 'Powered by üêØ - Modalit√† Scura OFF';
      }
    }

    // Carica preferenza modalit√† scura
    const darkModePref = localStorage.getItem('darkMode');
    updateDarkModeUI(darkModePref === 'on');

    footer.addEventListener('click', () => {
      const isDark = document.body.classList.toggle('dark-mode');
      footer.textContent = isDark
        ? 'Powered by üêØ - Modalit√† Scura ON'
        : 'Powered by üêØ - Modalit√† Scura OFF';
      localStorage.setItem('darkMode', isDark ? 'on' : 'off');
    });

    // Ricostruzione lista all'avvio e ad ogni input
    rebuildLists();
    searchInput.addEventListener('input', rebuildLists);
  </script>
</body>
</html>
